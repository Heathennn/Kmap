(function(e){function t(t){for(var r,a,d=t[0],s=t[1],h=t[2],c=0,u=[];c<d.length;c++)a=d[c],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&u.push(i[a][0]),i[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(u.length)u.shift()();return o.push.apply(o,h||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,d=1;d<n.length;d++){var s=n[d];0!==i[s]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var d=window["webpackJsonp"]=window["webpackJsonp"]||[],s=d.push.bind(d);d.push=t,d=d.slice();for(var h=0;h<d.length;h++)t(d[h]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),i=n.n(r);i.a},"537e":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],a=(n("034f"),n("2877")),d={},s=Object(a["a"])(d,i,o,!1,null,null,null),h=s.exports,l=n("8c4f"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("h2",[e._v("思维导图")]),e._m(0),e._m(1),n("Map")],1)},u=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("重构自某位 "),n("a",{attrs:{href:"https://github.com/RockyRen/mindmaptree"}},[e._v("不知名大佬")]),e._v(", 核心渲染方式已经重写, 并且增加了树状导图")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a",{attrs:{href:"https://github.com/Heathennn/Kmap#%E5%AF%BC%E5%9B%BE"}},[e._v("Docs")])])}],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"demo-svg"},[n("div",{staticClass:"mindmap"},[n("div",{staticClass:"mindmap-main"},[n("view-controller",{ref:"viewController",attrs:{childNodeCanDrag:e.childNodeCanDrag,graph:e.graph,renderer:e.renderer},on:{"update:childNodeCanDrag":function(t){e.childNodeCanDrag=t},"update:child-node-can-drag":function(t){e.childNodeCanDrag=t},updateTreeMap:e.updateTreeMap,updateMapDate:e.updateMapDate}}),n("div",{attrs:{id:"mindmapCanvas"}})],1)])])},g=[],v=(n("a4d3"),n("99af"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b"),n("2fa7")),p=(n("d267"),n("a434"),n("9f12")),N=n("53fe");n("7db0"),n("c740");function b(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}var m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(p["a"])(this,e),this.renderer=n,this.canDrag=i,t.hasOwnProperty("id")?this.id=t.id:this.id=r,t.hasOwnProperty("x")&&t.hasOwnProperty("y")?(this.x=t.x,this.y=t.y):(this.x=null,this.y=null),this.isRootNode=!!t.isRootNode,this.children=[],this.father=null,this.connectFather=null,this.connectChildren={},this.label=t.label||"任务"+this.id,this.shape=null,this.direction=t.direction||1,this.isTreeNode=t.isTreeMap||0,this.data=t.data||null}return Object(N["a"])(e,[{key:"setNodeDraggable",value:function(e){this.canDrag=e}},{key:"isDraggable",value:function(){return this.canDrag}},{key:"checkIsRootNode",value:function(){return this.isRootNode}},{key:"checkIsTreeMap",value:function(){return!!+this.isTree}},{key:"childrenCount",value:function(){return this.children.length}},{key:"childrenWithShapeCount",value:function(){var e=0;return this.children.forEach((function(t){t.shape&&e++})),e}},{key:"childrenCountIsOdd",value:function(){return!0&this.childrenCount()}},{key:"getMiddleChildNodeIndex",value:function(){return Math.floor(this.childrenCount()/2)}},{key:"getChildNodeIndex",value:function(e){return this.children.findIndex((function(t){return t.id==e}))}},{key:"getChildNode",value:function(e){return this.children.find((function(t){return t.id==e}))}},{key:"hasBrotherNode",value:function(){return this.father&&this.father.children.length>1}},{key:"isTreeMapNode",value:function(){return 1==this.isTreeNode}},{key:"isFirstLevelNode",value:function(){return this.father&&this.father.isRootNode}},{key:"isSecondMoreNode",value:function(){return!this.isRootNode&&!this.isFirstLevelNode()}},{key:"translate",value:function(e,t){this.x+=e,this.y+=t,this.renderer.translateSingleNodeRender(this,e,t),this.children.forEach((function(n){n.translate(e,t)}))}}]),e}(),y=function e(t,n,r){Object(p["a"])(this,e),this.id=++r,this.source=t,this.target=n,this.shape=null},C=-1,_=1;function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(v["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(){function e(){Object(p["a"])(this,e),this.nodeAccumulativeCount=0,this.edgeAccumulativeCount=0,this.nodes={},this.edges={},this.selected=null,this.root=null,this.gRenderer={},this.childNodesCanDrag=!1,this.tree=null,this.isTreeMap=1,this.rightNodeMaxCount=5}return Object(N["a"])(e,[{key:"init",value:function(e,t,n){this.tree=t,this.isTreeMap=n,this.gRenderer=e,this.root=this._initRoot(t&&t.label),t&&(this.setSelected(this.root),this.childNodesRender(t.children,this.selected),this.setSelected(null))}},{key:"getRootNode",value:function(){return this.root}},{key:"toggleChildNodeCanDrag",value:function(e){this.childNodesCanDrag=e}},{key:"setRightNodeMaxCount",value:function(e){this.rightNodeMaxCount=e}},{key:"childNodesRender",value:function(e,t){var n=this;e.forEach((function(e){var r=n._addNodeData(t,n.childNodesCanDrag,R({},e,{isTreeMap:n.isTreeMap}));e.children&&n.childNodesRender(e.children,r)}))}},{key:"addNode",value:function(){if(this.selected)return this._addNodeData(this.selected,this.childNodesCanDrag,{isTreeMap:this.isTreeMap})}},{key:"removeNode",value:function(){this.selected&&(this.selected.checkIsRootNode()?console.log("cannot remove root node"):(this._removeNodeData(this.selected),this.setSelected(null)))}},{key:"setLabel",value:function(e){this.selected&&(this.selected.label=e,this.gRenderer.setLabelRender(this.selected))}},{key:"setSelected",value:function(e){if(this.selected!==e){var t=this.selected;this.selected=e,this.gRenderer.setSelectedRender(this.selected,t)}}},{key:"getSelected",value:function(){return this.selected}},{key:"getNodes",value:function(){return this.nodes}},{key:"getParentAddableNodeSet",value:function(e){var t={};b(this.nodes,(function(e){t[e.id]=e}));var n=this._getChildrenNodeSet(e,{});return n[e.id]=e,e.father&&(n[e.father.id]=e.father),b(n,(function(e){delete t[e.id]})),t}},{key:"setParent",value:function(e,t){var n=this.nodes[e],r=this.nodes[t];if(r===n||null===n)return null;r.father!==n&&(delete r.father.children[r.id],this.gRenderer.removeNodeRender(r),this._setParentData(n,r),this._resetChildrenProperty(r.children),this.gRenderer.setParentRender(r))}},{key:"_getChildrenNodeSet",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n&&e.children&&e.children.forEach((function(e){n[e.id]=e,t._getChildrenNodeSet(e.children,n)})),n}},{key:"_addNodeData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new m(n,this.gRenderer,this.nodeAccumulativeCount,t);this.nodeAccumulativeCount++;var i=r.id;return this.nodes[i]=r,this._setParentData(e,r),this.gRenderer.addNodeRender(r),r}},{key:"_initRoot",value:function(e){console.log("set root node mode:",this.isTreeMap);var t=this._addNodeData(null,this.childNodesCanDrag,{x:this.gRenderer.getCanvasWidth()/2-50,y:200,id:0,isTreeMap:this.isTreeMap,isRootNode:!0});return t.label=e||"中心主题",this.gRenderer.rootNodeRender(t),t}},{key:"_removeNodeData",value:function(e){this._removeParentConnect(e),this.gRenderer.removeNodeRender(e),this._removeNodeDataRecursively(e)}},{key:"_addEdge",value:function(e,t,n){var r=new y(e,t,this.edgeAccumulativeCount);this.edgeAccumulativeCount++;var i=r.id;return this.edges[i]=r,r}},{key:"_setParentData",value:function(e,t){return t===e||null===e?null:t.father===e?t.connectFather:(this._removeParentConnect(t,!1),t.father=e,t.father.children.push(t),t.connectFather=this._addEdge(e,t),t.father.connectChildren[t.connectFather.id]=t.connectFather,void this._setNodeDirection(t))}},{key:"_removeParentConnect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.father,r=e.connectFather;if(n){var i=e.id,o=n.getChildNodeIndex(i);console.log("childrenIndex ==>",o),o>-1&&n.children.splice(o,1),console.log("nodeFather.children ==>",n.children),t&&delete this.nodes[i]}if(r){var a=r.id;delete n.connectChildren[a],delete this.edges[a]}}},{key:"_setNodeDirection",value:function(e){var t=e.father,n=t.checkIsRootNode(),r=!t;t.isTreeMapNode()?e.direction=1:n?this._isFirstNodeRightCountOverflow()?e.direction=C:e.direction=_:n||r||(e.direction=t.direction)}},{key:"_isFirstNodeRightMoreThanLeft",value:function(){var e=this.root;return e.children.forEach((function(e){-1===e.direction?0:1===e.direction&&0})),!1}},{key:"_isFirstNodeRightCountOverflow",value:function(){var e=this.root,t=0;return e.children.forEach((function(e){1===e.direction&&t++})),t>this.rightNodeMaxCount}},{key:"_removeNodeDataRecursively",value:function(e){var t=this;this._removeParentConnect(e),e.father=null,e.connectFather=null,e.children.forEach((function(e){t._removeNodeDataRecursively(e)}))}},{key:"_resetChildrenProperty",value:function(e){var t=this;e.forEach((function(e){e.connectFather=t._addEdge(e.father,e),t._setNodeDirection(e),t._resetChildrenProperty(e.children)}))}}]),e}(),w=n("452f"),x=n.n(w);function O(e,t,n,r,i){var o=e.getBBox(),a=o.width+i.width,d=o.height+i.height;e.attr({x:n+.5*a,y:r+.5*d}),t.attr({width:a,height:d})}function D(e,t,n,r,i){var o=e[0],a=e[1];o.attr({"font-size":25,fill:"white",text:r}),a.attr({rootAndFirstStroke:null}),"desktop"===i?a.attr({fill:"#428bca"}):"taskMore"===i&&a.attr({fill:"#64d4a5"});var d={width:42,height:24};O(o,a,t,n,d)}function M(e,t,n,r){var i=e[0],o=e[1];i.attr({"font-size":16,text:r}),o.attr({fill:"white",rootAndFirstStroke:null});var a={width:40,height:20};O(i,o,t,n,a)}function E(e,t,n,r){var i=e[0],o=e[1];i.attr({"font-size":15,text:r}),o.attr({secondMoreStroke:null});var a={width:20,height:10};O(i,o,t,n,a)}x.a.st.nodeShape=function(e,t){t=t||"desktop",e.checkIsRootNode()?D(this,e.x,e.y,e.label,t):e.isFirstLevelNode()?M(this,e.x,e.y,e.label):E(this,e.x,e.y,e.label)},x.a.st.selectedShape=function(e){this[1].attr({stroke:"#ff0033","stroke-width":2.5}),this.attr({opacity:1}),this[0].toFront()},x.a.st.unSelectedShape=function(e){e.isSecondMoreNode()?this[1].attr({secondMoreStroke:null}):this[1].attr({rootAndFirstStroke:null})},x.a.st.overlapShape=function(e){this[1].attr({stroke:"blue"})},x.a.st.unOverlapShape=function(e){e.isSecondMoreNode()?this[1].attr({secondMoreStroke:null}):this[1].attr({rootAndFirstStroke:null})},x.a.st.setLabel=function(e){this[0].attr({text:e.label})},x.a.st.dragNodeOpacityShape=function(e){x.a.st.unSelectedShape.call(this,e),this.attr({opacity:.4}),this.toFront()},x.a.st.opacityShape=function(){this.attr({opacity:.5})},x.a.st.unOpacityShape=function(){this.attr({opacity:1})};var T={init:function(e){e.customAttributes.rootAndFirstStroke=function(){return{stroke:"#808080","stroke-width":1}},e.customAttributes.secondMoreStroke=function(){return{stroke:"none"}}}},j=function(e,t){var n,r,i,o=e,a=t,d=1,s=o.clientWidth||400,h=o.clientHeight||400,l={x:0,y:0,width:s,height:h},c=!1,u=0,f=0;function g(e,t,n){d=n;var r=1/d;d>5&&(d=5),d<.2&&(d=.2),l.x=e,l.y=t,l.width=s*r,l.height=h*r;try{a.setViewBox(l.x,l.y,l.width,l.height)}catch(i){}}function v(e){i=1/d,u=e.layerX,f=e.layerY,c=!0}function p(e){c&&(n=-(e.layerX-u)*i,r=-(e.layerY-f)*i,l.x+=n,l.y+=r,g(l.x,l.y,d),u=e.layerX,f=e.layerY)}function N(e){c&&(c=!1)}function b(e){g(l.x,l.y,e)}function m(){o.addEventListener("mousedown",(function(e){"svg"===e.target.nodeName&&v(e)})),o.addEventListener("mousemove",(function(e){"svg"===e.target.nodeName&&p(e)})),o.addEventListener("mouseup",(function(e){"svg"===e.target.nodeName&&N(e)}))}return{isDragging:function(){return c},setViewportDrag:m,setViewportScale:b,getViewbox:function(){return l},mousedownHandle:v,mouseupHandle:N,mousemoveHandle:p}},P=j,F=(n("13d5"),function(){return{nodeDefaultWidth:80,nodeDefaultHeight:38,littleNodeDefaultHeight:26,nodeXInterval:12,nodeYInterval:20,getSingleNodeHeight:function(e){return e.shape?e.shape[1].attr("height"):e.isFirstLevelNode()?this.nodeDefaultHeight:this.littleNodeDefaultHeight},getSingleNodeWidth:function(e){return e.shape?e.shape[1].attr("width"):this.nodeDefaultWidth},getNodeAreaHeight:function(e){if(e.childrenCount()>0){var t=0;for(var n in e.children)t+=this.getNodeAreaHeight(e.children[n]);return t}return this.getSingleNodeHeight(e)+this.nodeYInterval},getNodeAreaWidth:function(e){if(e.childrenCount()>0){var t=0;for(var n in e.children)t+=this.getNodeAreaWidth(e.children[n]);return t}return this.getSingleNodeWidth(e)+this.nodeYInterval},getChildHeadNode:function(e){return e.childrenCount()?e.children[0].childrenCount()?this.getChildHeadNode(e.children[0]):e.children[0]:e},getChildLastNode:function(e){return e.childrenCount()?e.children[e.childrenCount()-1].childrenCount()?this.getChildLastNode(e.children[e.childrenCount()-1]):e.children[e.childrenCount()-1]:e},getChildFarLeftNode:function(e){function t(e){n.push(e.children[0]),e.children[0].childrenCount()&&t(e.children[0])}var n=[];n.push(e),e.childrenCount()&&t(e);var r=n.reduce((function(e,t){return e.x?(e.x>t.x&&(e=t),e):(e=t,e)}),{});return r},getChildFarRightNode:function(e){var t=this;function n(e){r.push(e.children[e.childrenCount()-1]),e.children[e.childrenCount()-1].childrenCount()&&n(e.children[e.childrenCount()-1])}var r=[];r.push(e),e.childrenCount()&&n(e);var i=r.reduce((function(e,n){return e.x?(e.x+t.getSingleNodeWidth(e)<n.x+t.getSingleNodeWidth(n)&&(e=n),e):(e=n,e)}),{});return i},getOffsetYWithHeadNode:function(e){var t=this.getChildHeadNode(e);return Math.abs(t.y-e.y)},getOffsetYWidthLastNode:function(e){var t=this.getChildLastNode(e);return Math.abs(t.y-e.y)},getOffsetXBetweenNodes:function(e,t){return Math.abs(e.x-t.x)},getOffsetXWithHeadNode:function(e){var t=this.getChildHeadNode(e);return this.getOffsetXBetweenNodes(t,e)},getOffsetXWidthLastNode:function(e){var t=this.getChildLastNode(e);return this.getOffsetXBetweenNodes(t,e)}}}()),I=F;var H=function(){return{createRenderStrategy:function(e,t,n,r){var i;return i=e.childrenCountIsOdd()?new W(new X(t,n,r)):new W(new B(t,n,r)),i}}}();function W(e){this.strategy=e}function Y(e,t,n){this.nodeXInterval=100,this.nodeYInterval=60,this.treeNodeXInterval=60,this.treeNodeYInterval=100,this.drawNode=e,this.drawEdge=t,this.setDrag=n}function X(e,t,n){this.drawNode=e,this.drawEdge=t,this.setDrag=n}function B(e,t,n){this.drawNode=e,this.drawEdge=t,this.setDrag=n}W.prototype.reRenderChildrenNode=function(e){this.strategy.doRender(e)},Y.prototype.commonOddRender=function(e,t,n){var r=e.x+I.getSingleNodeWidth(e)/2,i=e.y+I.getSingleNodeHeight(e)/2,o=e.getMiddleChildNodeIndex(),a=t[o],d=r+I.getSingleNodeWidth(e)/2+this.nodeXInterval,s=i-I.getSingleNodeHeight(a)/2;this._reRenderNode(a,d,s);for(var h=o-1;h>=0;h--){var l=d,c=I.getChildHeadNode(t[h+1]),u=c.y-this.nodeYInterval-I.getSingleNodeHeight(t[h])-I.getOffsetYWidthLastNode(t[h]);this._reRenderNode(t[h],l,u)}for(var f=o+1;f<t.length;f++){var g=d,v=I.getChildLastNode(t[f-1]),p=v.y+I.getSingleNodeHeight(t[f-1])+this.nodeYInterval+I.getOffsetYWithHeadNode(t[f]);this._reRenderNode(t[f],g,p)}},Y.prototype.commonEvenRender=function(e,t,n){for(var r=e.x+I.getSingleNodeWidth(e)/2,i=e.y+I.getSingleNodeHeight(e)/2,o=e.getMiddleChildNodeIndex(),a=r+I.getSingleNodeWidth(e)/2+this.nodeXInterval,d=i,s=o-1;s>=0;s--)if(s===o-1){var h=a,l=d-this.nodeYInterval/2-I.getSingleNodeHeight(t[s])-I.getOffsetYWidthLastNode(t[s]);this._reRenderNode(t[s],h,l)}else{var c=a,u=I.getChildHeadNode(t[s+1]),f=u.y-this.nodeYInterval-I.getSingleNodeHeight(t[s])-I.getOffsetYWidthLastNode(t[s]);this._reRenderNode(t[s],c,f)}for(var g=o;g<t.length;g++)if(g===o){var v=a,p=d+this.nodeYInterval/2+I.getOffsetYWithHeadNode(t[g]);this._reRenderNode(t[g],v,p)}else{var N=a,b=I.getChildLastNode(t[g-1]),m=b.y+I.getSingleNodeHeight(t[g-1])+this.nodeYInterval+I.getOffsetYWithHeadNode(t[g]);this._reRenderNode(t[g],N,m)}},Y.prototype.commonTreeOddRender=function(e,t,n){var r=e.x+I.getSingleNodeWidth(e)/2,i=e.y+I.getSingleNodeHeight(e)/2,o=e.getMiddleChildNodeIndex(),a=t[o],d=r-I.getSingleNodeWidth(a)/2,s=i+I.getSingleNodeHeight(e)/2+this.treeNodeYInterval;this._reRenderNode(a,d,s);for(var h=o-1;h>=0;h--){var l=s,c=I.getChildFarLeftNode(t[h+1]),u=I.getChildFarRightNode(t[h]),f=c.x-this.treeNodeYInterval-I.getSingleNodeWidth(u)-I.getOffsetXBetweenNodes(u,t[h]);this._reRenderNode(t[h],f,l)}for(var g=o+1;g<t.length;g++){var v=s,p=I.getChildFarRightNode(t[g-1]),N=I.getChildFarLeftNode(t[g]),b=p.x+I.getSingleNodeWidth(p)+this.treeNodeYInterval+I.getOffsetXBetweenNodes(N,t[g]);this._reRenderNode(t[g],b,v)}},Y.prototype.commonTreeEvenRender=function(e,t,n){for(var r=e.x+I.getSingleNodeWidth(e)/2,i=e.y+I.getSingleNodeHeight(e)/2,o=e.getMiddleChildNodeIndex(),a=r,d=i+I.getSingleNodeHeight(e)/2+this.treeNodeYInterval,s=o-1;s>=0;s--)if(s===o-1){var h=d,l=I.getChildFarRightNode(t[s]),c=a-this.treeNodeXInterval/2-I.getSingleNodeWidth(l)-I.getOffsetXBetweenNodes(l,t[s]);this._reRenderNode(t[s],c,h)}else{var u=d,f=I.getChildFarLeftNode(t[s+1]),g=I.getChildFarRightNode(t[s]),v=f.x-this.treeNodeXInterval-I.getSingleNodeWidth(g)-I.getOffsetXBetweenNodes(t[s],g);this._reRenderNode(t[s],v,u)}for(var p=o;p<t.length;p++)if(p===o){var N=d,b=I.getChildFarLeftNode(t[p]),m=a+this.treeNodeXInterval/2+I.getOffsetXBetweenNodes(b,t[p]);this._reRenderNode(t[p],m,N)}else{var y=d,C=I.getChildFarRightNode(t[p-1]),_=I.getChildFarLeftNode(t[p]),k=C.x+I.getSingleNodeWidth(C)+this.treeNodeXInterval+I.getOffsetXBetweenNodes(_,t[p]);this._reRenderNode(t[p],k,y)}},Y.prototype._reRenderNode=function(e,t,n){if(e.shape){var r=t-e.x,i=n-e.y;e.translate(r,i)}else e.x=t,e.y=n,this.drawNode(e)},Y.prototype.doRender=function(e){console.log("该方法应该被覆盖")},X.prototype=new Y,X.prototype.constructor=X,X.prototype.doRender=function(e){e.isTreeMapNode()?this.commonTreeOddRender(e,e.children,1):this.commonOddRender(e,e.children,e.direction)},B.prototype=new Y,B.prototype.constructor=B,B.prototype.doRender=function(e){e.isTreeMapNode()?this.commonTreeEvenRender(e,e.children,1):this.commonEvenRender(e,e.children,e.direction)};var A=H,L=(n("caad"),function(e){var t,n=e.source,r=e.target,i=n.shape[0].paper,o=n.shape.getBBox(),a=r.shape.getBBox(),d=n.isTreeMapNode();function s(e){return{x:(e.x+e.x2)/2,y:(e.y+e.y2)/2}}function h(e,t,n,r,i){if(["start","end"].includes(e)){var o="start"===e,a=i?0:(o?n:-n)*(r.width/2),d=i?(o?n:-n)*(r.height/2):0,s=t.x+a,h=t.y+d;return{x:s,y:h}}}function l(e,t,n,r,i){if(["start","end"].includes(e)){var o="start"===e,a=o?n:-n,d=o?"StartOffsetX":"EndOffsetX",s=o?"StartOffsetY":"EndOffsetY",h=i?0:a*r[d],l=i?a*r[s]:0,c=t.x+h,u=t.y+l;return{x:c,y:u}}}function c(){var n=s(o),d=(a.x+a.x2)/2-r.direction*a.width/2,h=(a.y+a.y2)/2,l=.8,c=.2,u={x1:n.x,y1:n.y,x2:d,y2:h,x3:d-l*(d-n.x),y3:h-c*(h-n.y)},f=i.path(x.a.fullfill("M{x1},{y1}Q{x3},{y3},{x2},{y2}",u));f.attr({stroke:"#999","stroke-width":2}),f.toBack(),t=i.set().push(f),e.shape&&(e.shape[0].remove(),e.shape=t),e.shape=t}function u(){var n=s(o),c=s(a),u=h("start",n,r.direction,o,d),f=h("end",c,r.direction,a,d),g={StartOffsetX:20,StartOffsetY:10,EndOffsetX:30,EndOffsetY:10},v={StartOffsetX:10,StartOffsetY:20,EndOffsetX:10,EndOffsetY:30},p=d?v:g,N=l("start",u,r.direction,p,d),b=l("end",f,r.direction,p,d),m={startX:u.x,startY:u.y,endX:f.x,endY:f.y,startControllerX:N.x,startControllerY:N.y,endControllerX:b.x,endControllerY:b.y},y=i.path(x.a.fullfill("M{startX},{startY}C{startControllerX} {startControllerY},{endControllerX} {endControllerY},{endX} {endY}",m));y.attr({stroke:"#999","stroke-width":2}),y.toBack(),t=i.set().push(y),e.shape&&(e.shape[0].remove(),e.shape=t),e.shape=t}return{drawEdge:function(){return d?u():n.checkIsRootNode()?c():u(),t}}});var $=L,V=(n("e25e"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e,r=t.viewportHandle,i=t.paper,o=t.graph,a=null,d=null,s=null,h=null,l={canRender:t.canRender||!0};function c(e){var t=e.shape[1].clone();t.attr({r:4});var n=e.shape[0].clone(),r=i.set().push(n).push(t);return r}function u(){var e={},t=o.getParentAddableNodeSet(n);return b(t,(function(t){e[t.id]=t.shape.getBBox()})),e}function f(){var e=n.shape.getBBox();for(var t in d){var r=d[t];if(x.a.isBBoxIntersect(e,r))return t}return null}function g(e){e.forEach((function(e){e.shape.opacityShape(e),e.connectFather.shape.opacityShape(),g(e.children)}))}function v(e){e.forEach((function(e){e.shape.unOpacityShape(),e.connectFather.shape.unOpacitShape(),v(e.children)}))}function p(e,t){if(!l.canRender||!n.isDraggable())return!1;n.shape[1].node.style.cursor="move",n.shape.transform("t"+e+","+t),h=f();var r=o.getNodes();h!==s&&(h&&r[h].shape.overlapShape(),s&&r[s].shape.unOverlapShape(r[s])),s=h}function N(){return!!l.canRender&&(o.setSelected(n),!!n.isDraggable()&&(a=c(n),n.shape.dragNodeOpacityShape(n),a.opacityShape(),g(n.children),d=u(),void(s=null)))}function m(){if(!l.canRender||!n.isDraggable())return!1;if(a.remove(),a=null,n.shape.selectedShape(n),v(n.children),s){var e=o.getNodes(),t=e[s];t.shape.nodeShape(t)}if(h=f(),h){o.getNodes();o.setParent(parseInt(h),n.id)}n.shape.transform("t0,0"),n.shape[1].node.style.cursor="default"}return n.shape.click((function(e){console.log("e ==>",e)})),{setDrag:function(){n.checkIsRootNode()?(n.shape.mousedown((function(e){if(!l.canRender)return!1;r.mousedownHandle(e)})),n.shape.mousemove((function(e){if(!l.canRender)return!1;r.mousemoveHandle(e)})),n.shape.mouseup((function(e){if(!l.canRender)return!1;r.mouseupHandle(e)})),n.shape.mousedown((function(){if(!l.canRender)return!1;o.setSelected(n)})),n.shape.mousemove((function(){if(!l.canRender)return!1;r.isDragging()})),n.shape.mouseup((function(){if(!l.canRender)return!1}))):n.shape.drag(p,N,m)}}}),z=V,G=function(){function e(t,n){Object(p["a"])(this,e),this.graph=n,this.canvasDom=document.getElementById(t.canvasId),this.paper=new x.a(this.canvasDom),this.canvasClickCb=t.canvasClickCb,this.nodeClickCb=t.nodeClickCb,this.viewportHandle=P(this.canvasDom,this.paper),this.viewportHandle.setViewportDrag(),T.init(this.paper),this.setCanvasClick()}return Object(N["a"])(e,[{key:"addNodeRender",value:function(e){var t=this;e.x&&e.y?this.drawNode(e):(this._resetBrotherPosition(e),e.father&&e.father.childrenCount()>1&&e.father.father),e.connectFather&&this._drawEdge(e.connectFather),this._setDrag(e),e.shape.mousedown((function(){t.nodeClickCb&&t.nodeClickCb(e.label)}))}},{key:"getCanvasWidth",value:function(){return this.canvasDom.clientWidth}},{key:"removeNodeRender",value:function(e){this.removeNodeAndChildrenShape(e),e.father&&this._resetBrotherPosition(e.father)}},{key:"translateSingleNodeRender",value:function(e,t,n){if(e.shape){var r=e.shape[1],i=r.attr("x"),o=r.attr("y");r.attr({x:i+t,y:o+n});var a=e.shape[0],d=a.attr("x"),s=a.attr("y");a.attr({x:d+t,y:s+n})}e.shape&&e.connectFather&&this._drawEdge(e.connectFather)}},{key:"setSelectedRender",value:function(e,t){e&&e.shape&&e.shape.selectedShape(e),t&&t.shape&&t.shape.unSelectedShape(t)}},{key:"setLabelRender",value:function(e){var t=I.getSingleNodeWidth(e);e.shape.nodeShape(e),this.graph.selected&&this.graph.selected.shape.selectedShape(e);var n=I.getSingleNodeWidth(e),r=n-t;this._resetBrotherPosition(e),e.direction===_?(e.children.forEach((function(e){e.translate(r,0)})),e.shape&&e.connectFather&&this._drawEdge(e.connectFather)):e.direction===C?e.translate(-r,0):e.checkIsRootNode()&&(e.translate(-r/2,0),e.children.forEach((function(e){1===e.direction?e.translate(r,0):-1===e.direction&&e.translate(-r/2,0)})))}},{key:"rootNodeRender",value:function(e){var t=I.getSingleNodeWidth(e);e.shape.nodeShape(e);var n=I.getSingleNodeWidth(e),r=n-t;e.translate(-r/2,0),e.children.forEach((function(e){e.direction===_&&e.translate(r,0)}))}},{key:"drawNode",value:function(e){var t=this.paper,n=t.text(e.x,e.y,e.label),r=n.getBBox(),i=(r.width,r.height,t.rect(e.x,e.y,I.nodeDefaultWidth,I.nodeDefaultHeight,4).data("id",e.id));n.toFront(),e.shape=t.set().push(n).push(i),e.shape.nodeShape(e)}},{key:"setCanvasClick",value:function(){var e=this;this.canvasDom.addEventListener("mousedown",(function(t){"svg"===t.target.nodeName&&(e.graph.setSelected(null),e.canvasClickCb&&e.canvasClickCb())}))}},{key:"setParentRender",value:function(e){var t=this;e.father.childrenWithShapeCount();this._reRenderChildrenNode(e.father);e.father.childrenWithShapeCount();e.father&&e.father.childrenCount(),e.connectFather&&this._drawEdge(e.connectFather),this._setDrag(e),e.children.forEach((function(e){t.setParentRender(e)}))}},{key:"_drawEdge",value:function(e){var t=$(e);t.drawEdge()}},{key:"_reRenderChildrenNode",value:function(e){var t=A.createRenderStrategy(e,this.drawNode.bind(this),this._drawEdge.bind(this),this._setDrag.bind(this));t.reRenderChildrenNode(e)}},{key:"_resetBrotherPosition",value:function(e,t,n){var r=this;function i(e){e.father&&r._reRenderChildrenNode(e.father),e.father&&e.father.father&&i(e.father)}function o(e){e.childrenCount()&&r._reRenderChildrenNode(e),e.childrenCount()&&e.children.forEach((function(e){o(e)}))}o(e),i(e)}},{key:"removeNodeAndChildrenShape",value:function(e){var t=this;e.shape&&(e.shape.remove(),e.shape=null),e.connectFather.shape&&(e.connectFather.shape.remove(),e.connectFather=null),e.children.forEach((function(e){t.removeNodeAndChildrenShape(e)}))}},{key:"_setDrag",value:function(e){var t=z(e,{viewportHandle:this.viewportHandle,paper:this.paper,graph:this.graph});t.setDrag()}}]),e}(),J=n("1157"),K=n.n(J),Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"view-controller"},[n("button",{staticClass:"toolbar-btn btn btn-default btn-sm btn-success node-plus",on:{click:e.minusScale}},[e._v("- ")]),n("span",[e._v(e._s(e.scale))]),n("button",{staticClass:"toolbar-btn btn btn-default btn-sm btn-success node-plus",on:{click:e.plusScale}},[e._v("+ ")]),n("div",[n("span",[e._v("右侧最大节点数")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.rightNodeMaxCount,expression:"rightNodeMaxCount"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.rightNodeMaxCount=t.target.multiple?n:n[0]}}},e._l(e.rightNodeMaxCounts,(function(t){return n("option",{key:t,domProps:{value:t}},[e._v(e._s(t))])})),0)]),n("button",{staticClass:"toolbar-btn btn btn-default btn-sm btn-success node-btn disabled",on:{click:e.addNode}},[e._v("添加节点")]),n("button",{staticClass:"toolbar-btn btn btn-default btn-sm btn-danger node-btn disabled",on:{click:e.removeNode}},[e._v("删除节点 ")]),n("button",{staticClass:"toolbar-btn btn btn-default btn-sm btn-success",on:{click:e.toggleDraggable}},[e._v("暂不支持拖拽节点 ")]),n("button",{staticClass:"toolbar-btn btn btn-default btn-sm",on:{click:e.saveData}},[e._v("保存数据(console)")]),n("button",{staticClass:"toolbar-btn btn btn-default btn-sm",on:{click:function(t){e.$emit("updateMapDate",e.randomTree())}}},[e._v("替换数据 ")]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.isTreeMap,expression:"isTreeMap"}],staticClass:"check-map-mode",attrs:{type:"checkbox",id:"check-map-mode"},domProps:{checked:Array.isArray(e.isTreeMap)?e._i(e.isTreeMap,null)>-1:e.isTreeMap},on:{change:function(t){var n=e.isTreeMap,r=t.target,i=!!r.checked;if(Array.isArray(n)){var o=null,a=e._i(n,o);r.checked?a<0&&(e.isTreeMap=n.concat([o])):a>-1&&(e.isTreeMap=n.slice(0,a).concat(n.slice(a+1)))}else e.isTreeMap=i}}}),n("label",{attrs:{for:"check-map-mode"}},[e._v("树状导图")])]),n("div",{staticClass:"label-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentText,expression:"currentText"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.currentText},on:{input:function(t){t.target.composing||(e.currentText=t.target.value)}}}),n("button",{staticClass:"btn btn-default btn-sm node-btn",on:{click:e.setGraphText}},[e._v("确定")])])])},q=[],U=(n("d81d"),n("5c8a")),Z={name:"ViewController",props:{childNodeCanDrag:{type:Boolean,default:!0},renderer:{},graph:{}},data:function(){return{currentText:"",isTreeMap:!0,scale:1,rightNodeMaxCount:5,rightNodeMaxCounts:[2,3,4,5,6,7,8]}},watch:{isTreeMap:function(e){this.$emit("updateTreeMap",e?1:0)},rightNodeMaxCount:function(e){this.graph.setRightNodeMaxCount(e)}},methods:{setGraphText:function(){this.currentText&&this.graph.setLabel(this.currentText)},addNode:function(){this.graph.addNode()},removeNode:function(){this.graph.removeNode()},toggleDraggable:function(){},saveData:function(){var e=this.renderer.graph.getRootNode(),t=Object(U["a"])(e),n=this.formatData(t);console.log("保存的数据 ==>",n)},parseNode:function(e){var t,n=e.direction,r=e.isRootNode,i=e.id,o=e.label,a=e.isTreeNode,d=e.children;return t={direction:n,isRootNode:r,id:i,label:o,isTreeNode:a,children:d},t},formatData:function(e){var t=this;return e.children&&e.children.length?{id:e.id,label:e.label,isRootNode:!!e.isRootNode,children:e.children.map((function(e){return t.formatData(e)}))}:{id:e.id,label:e.label,isRootNode:!!e.isRootNode,children:[]}},randomTree:function(){for(var e={isRootNode:!0,id:0,label:"根节点-".concat(this.randomNumber()),children:[]},t={direction:1,id:0,label:"",children:[]},n=this.randomNumber(1,5),r=1;r<n;r++)t.id=r,t.label="节点".concat(r,"-").concat(this.randomNumber()),e.children.push(t);return e},randomNumber:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Math.floor(Math.random()*t+e)},minusScale:function(){var e=this.scale;e-=.5,e<.5&&(e=.5),this.renderer.viewportHandle.setViewportScale(e),this.scale=e},plusScale:function(){var e=this.scale;e+=.5,e>5&&(e=5),this.renderer.viewportHandle.setViewportScale(e),this.scale=e}}},ee=Z,te=(n("d8af"),Object(a["a"])(ee,Q,q,!1,null,null,null)),ne=te.exports;function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(n,!0).forEach((function(t){Object(v["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe={components:{ViewController:ne},data:function(){return{childNodeCanDrag:!1,graph:null,renderer:null,scale:1,isTreeMap:1,tree:{children:[{direction:1,isRootNode:!1,id:1,label:"节点1",children:[{direction:1,isRootNode:!1,id:3,label:"节点3"},{direction:1,isRootNode:!1,id:4,label:"节点4"}]},{direction:1,isRootNode:!1,id:2,label:"节点2",children:[{direction:1,isRootNode:!1,id:5,label:"节点5"},{direction:1,isRootNode:!1,id:6,label:"节点6"}]}],direction:-1,isRootNode:!0,id:0,label:"根节点"}}},watch:{childNodeCanDrag:function(e){this.renderer.graph.toggleChildNodeCanDrag(e);var t=this.getAllNodes();this.renderer&&this.toggleNodeDraggable(t,e)}},methods:{randomTree:function(){for(var e={direction:1,isRootNode:!0,id:0,label:"根节点-".concat(this.randomNumber()),children:{}},t={direction:1,isRootNode:!1,id:0,label:"",children:{}},n=this.randomNumber(1,10),r=1;r<n;r++)t.id=r,t.label="节点".concat(r,"-").concat(this.randomNumber()),e.children[r]=ie({},t);return e},randomNumber:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Math.floor(Math.random()*t+e)},toggleDraggable:function(){this.childNodeCanDrag=!this.childNodeCanDrag},toggleNodeDraggable:function(e,t){b(e,(function(e){e.setNodeDraggable(t)}))},updateTreeMap:function(e){this.isTreeMap=e,this.updateMapDate(this.tree)},getAllNodes:function(){return this.renderer.graph.getNodes()},removeAllChildNodes:function(){var e=this,t=this.getAllNodes();b(t,(function(t){t.isRootNode||e.renderer.removeNodeRender(t)}))},initMap:function(){var e=this;this.graph=new S,this.renderer=new G({canvasId:"mindmapCanvas",canDrag:e.childNodeCanDrag,canvasClickCb:function(){K()(".label-group input").val(""),K()(".node-btn").addClass("disabled")},nodeClickCb:function(t){e.$refs.viewController.currentText=t,K()(".node-btn").removeClass("disabled")}},{setSelected:e.graph.setSelected.bind(e.graph),getParentAddableNodeSet:e.graph.getParentAddableNodeSet.bind(e.graph),getSelected:e.graph.getSelected.bind(e.graph),getNodes:e.graph.getNodes.bind(e.graph),getRootNode:e.graph.getRootNode.bind(e.graph),setParent:e.graph.setParent.bind(e.graph),toggleChildNodeCanDrag:e.graph.toggleChildNodeCanDrag.bind(e.graph)})},updateMapDate:function(e){this.renderer&&K()("#mindmapCanvas").html(""),this.initMap(),this.graph.init(this.renderer,e,this.isTreeMap)}},mounted:function(){var e=this;this.initMap(),this.updateMapDate(this.tree),K()(".label-group button").click((function(){var t=K()(".label-group input").val();e.graph.setLabel(t)}))}},ae=oe,de=(n("cd42"),Object(a["a"])(ae,f,g,!1,null,"214cc2f0",null)),se=de.exports,he=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("h1",[e._v(e._s(e.msg))]),e._m(0),n("h3",[e._v("Installed CLI Plugins")]),e._m(1),n("h3",[e._v("Essential Links")]),e._m(2),n("h3",[e._v("Ecosystem")]),e._m(3)])},le=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v(" For a guide and recipes on how to configure / customize this project,"),n("br"),e._v(" check out the "),n("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-cli documentation")]),e._v(". ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank",rel:"noopener"}},[e._v("babel")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint",target:"_blank",rel:"noopener"}},[e._v("eslint")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Core Docs")])]),n("li",[n("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Forum")])]),n("li",[n("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Community Chat")])]),n("li",[n("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"}},[e._v("Twitter")])]),n("li",[n("a",{attrs:{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("News")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://router.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-router")])]),n("li",[n("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vuex")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank",rel:"noopener"}},[e._v("vue-devtools")])]),n("li",[n("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-loader")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"}},[e._v("awesome-vue")])])])}],ce={name:"HelloWorld",props:{msg:String}},ue=ce,fe=(n("e212"),Object(a["a"])(ue,he,le,!1,null,"df6a9e02",null)),ge=fe.exports,ve={name:"home",components:{HelloWorld:ge,Map:se}},pe=ve,Ne=Object(a["a"])(pe,c,u,!1,null,null,null),be=Ne.exports;r["a"].use(l["a"]);var me=[{path:"/",name:"home",component:be}],ye=new l["a"]({mode:"history",base:"/",routes:me}),Ce=ye;r["a"].config.productionTip=!1,new r["a"]({router:Ce,render:function(e){return e(h)}}).$mount("#app")},"5a39":function(e,t,n){},"691a":function(e,t,n){},"85ec":function(e,t,n){},cd42:function(e,t,n){"use strict";var r=n("537e"),i=n.n(r);i.a},d267:function(e,t,n){},d8af:function(e,t,n){"use strict";var r=n("691a"),i=n.n(r);i.a},e212:function(e,t,n){"use strict";var r=n("5a39"),i=n.n(r);i.a}});
//# sourceMappingURL=app.b249a7d2.js.map